{"is_source_file": true, "format": "TypeScript", "description": "This file defines an Angular component 'FigmaScreenComponent' that renders an embedded Figma design inside an Angular application by inlining static HTML content and dynamically injecting associated CSS and JavaScript assets. It manages asset URL rewriting, injection, and cleanup to ensure seamless integration of the Figma design mockup into the app.", "external_files": ["/assets/common.css", "/assets/spotify-1-0-3.css", "/assets/app.js", "/assets/spotify-1-0-3.js"], "external_methods": ["this.appendStylesheet", "this.appendScript", "this.extractBodyInnerHtml", "this.rewriteAssetUrls"], "published": ["htmlContent"], "classes": [{"name": "FigmaScreenComponent", "description": "An Angular standalone component that renders a static Figma design embedded as inline HTML. It handles asset inlining, URL rewriting, and cleanup of dynamically added stylesheet and script elements."}], "methods": [{"name": "ngOnInit", "description": "Initializes the component, injects necessary stylesheets and scripts, and sets the inline sanitized HTML content from the embedded static HTML string."}, {"name": "ngOnDestroy", "description": "Cleans up dynamically injected stylesheet and script nodes to prevent duplication on navigation."}, {"name": "appendStylesheet", "description": "Creates and appends a stylesheet link element with the specified href, avoiding duplicates."}, {"name": "appendScript", "description": "Creates and appends a script element with the specified src, with an option to defer, avoiding duplicates."}, {"name": "getSourceHtml", "description": "Returns the full static HTML source of the embedded Figma page, embedded directly as a string to avoid runtime fetches."}, {"name": "extractBodyInnerHtml", "description": "Extracts the inner content of the <body> tag from the full HTML string, removing <script> tags for security."}, {"name": "rewriteAssetUrls", "description": "Converts relative asset URLs in the HTML to absolute '/assets/' paths, and removes certain link tags to ensure assets load correctly."}], "calls": ["this.appendStylesheet", "this.appendScript", "this.extractBodyInnerHtml", "this.rewriteAssetUrls"], "search-terms": ["FigmaScreenComponent", "embedded static HTML", "asset URL rewriting", "Angular standalone component", "inline HTML", "asset injection", "cleanup injected nodes", "/assets/common.css", "/assets/spotify-1-0-3.css"], "state": 2, "file_id": 21, "knowledge_revision": 78, "git_revision": "698a049d1d397bf3d5afd587ca9490f8c266e62d", "revision_history": [{"43": ""}, {"47": ""}, {"48": ""}, {"49": ""}, {"51": "d996abcea0f056656a880b277976ad2dab0099d9"}, {"52": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"53": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"56": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"58": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"60": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"61": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"62": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"63": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"64": "4b9dc0675dd9a7ae5545a20a373cceabb6fc7151"}, {"70": "157fde7c8bedd3fa7f552e8711f6457899011078"}, {"72": "225919db5faaa0f9b7e75dc979e7764cbd858f6a"}, {"73": "ddf928e8c99f574a599461d6bc6ef46ae7e5f61d"}, {"74": "ddf928e8c99f574a599461d6bc6ef46ae7e5f61d"}, {"75": "ddf928e8c99f574a599461d6bc6ef46ae7e5f61d"}, {"76": "ddf928e8c99f574a599461d6bc6ef46ae7e5f61d"}, {"77": "698a049d1d397bf3d5afd587ca9490f8c266e62d"}, {"78": "698a049d1d397bf3d5afd587ca9490f8c266e62d"}], "ctags": [{"_type": "tag", "name": "FigmaScreenComponent", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^export class FigmaScreenComponent implements OnInit, OnDestroy {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const body = this.doc.body || this.doc.getElementsByTagName('body')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "bodyMatch", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const bodyMatch = html.match(\\/<body[^>]*>([\\\\s\\\\S]*?)<\\\\\\/body>\\/i);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    let content = html;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "css1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const css1 = this.appendStylesheet('\\/assets\\/common.css') || this.appendStylesheet('asset/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "css2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const css2 = this.appendStylesheet('\\/assets\\/spotify-1-0-3.css') || this.appendStylesheet/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "doc", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^  private readonly doc = inject(DOCUMENT);$/", "language": "TypeScript", "kind": "property", "scope": "FigmaScreenComponent", "scopeKind": "class"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = head.querySelector(`link[rel=\"stylesheet\"][href=\"${href}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = this.doc.querySelector(`script[src=\"${src}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "head", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const head = this.doc.head || this.doc.getElementsByTagName('head')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "inlineHtml", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    const inlineHtml = this.rewriteAssetUrls(this.extractBodyInnerHtml(this.getSourceHtml()));$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "js1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js1 = this.appendScript('\\/assets\\/app.js', false) || this.appendScript('assets\\/app/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "js2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js2 = this.appendScript('\\/assets\\/spotify-1-0-3.js', false) || this.appendScript('a/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "link", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const link = this.doc.createElement('link');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    for (const node of this.addedNodes) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    let out = html;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "script", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const script = this.doc.createElement('script');$/", "language": "TypeScript", "kind": "constant"}], "hash": "c2b8df0444aa4d65d53c6e12b5577f18", "format-version": 4, "code-base-name": "web_frontend", "filename": "web_frontend/src/app/figma-screen/figma-screen.component.ts", "fields": [{"name": "let content = html;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private readonly doc = inject(DOCUMENT);", "scope": "FigmaScreenComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "let out = html;", "scope": "", "scopeKind": "", "description": "unavailable"}]}