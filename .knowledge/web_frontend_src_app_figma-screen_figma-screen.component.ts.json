{"is_source_file": true, "format": "TypeScript", "description": "Angular component for rendering a Figma screen by injecting sanitized HTML, managing assets and scripts dynamically, and embedding external HTML content from assets/spotify-1-0-3.html.", "external_files": ["assets/common.css", "assets/spotify-1-0-3.css", "assets/spotify-1-0-3.html", "assets/app.js", "assets/spotify-1-0-3.js"], "external_methods": ["inject", "isPlatformBrowser"], "published": ["FigmaScreenComponent"], "classes": [{"name": "FigmaScreenComponent", "description": "Angular component that injects external Figma HTML into the app, managing styles, scripts, and sanitization for secure rendering."}], "methods": [{"name": "ngOnInit", "description": "Lifecycle hook that loads external HTML, CSS, and JS assets, sanitizes HTML, and injects it into the component template."}, {"name": "ngOnDestroy", "description": "Cleans up dynamically injected nodes when component is destroyed."}, {"name": "appendStylesheet", "description": "Injects a stylesheet link into document head if not already present."}, {"name": "appendScript", "description": "Appends a script element into document body if not already included."}, {"name": "extractBodyInnerHtml", "description": "Extracts inner HTML of the <body> tag from a full HTML document string."}, {"name": "rewriteAssetUrls", "description": "Rewrites relative URLs inside fetched HTML to absolute /assets/... paths for proper resolution."}, {"name": "addBaseShim", "description": "Optionally adds a <base> element to document head for resolving relative paths (not actively used)."}], "calls": ["inject", "isPlatformBrowser", "globalThis.fetch", "this.appendStylesheet", "this.appendScript", "this.extractBodyInnerHtml", "this.rewriteAssetUrls"], "search-terms": ["FigmaScreenComponent", "Angular dynamic HTML injection", "assets stylesheet and script injection", "html sanitization", "fetch external HTML assets"], "state": 2, "file_id": 21, "knowledge_revision": 63, "git_revision": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a", "revision_history": [{"43": ""}, {"47": ""}, {"48": ""}, {"49": ""}, {"51": "d996abcea0f056656a880b277976ad2dab0099d9"}, {"52": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"53": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"56": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"58": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"60": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"61": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"62": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"63": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}], "ctags": [{"_type": "tag", "name": "FigmaScreenComponent", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^export class FigmaScreenComponent implements OnInit, OnDestroy {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "base", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const base = this.doc.createElement('base');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const body = this.doc.body || this.doc.getElementsByTagName('body')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "bodyMatch", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const bodyMatch = html.match(\\/<body[^>]*>([\\\\s\\\\S]*?)<\\\\\\/body>\\/i);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "css1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    const css1 = this.appendStylesheet('assets\\/common.css');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "css2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    const css2 = this.appendStylesheet('assets\\/spotify-1-0-3.css');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "doc", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^  private readonly doc = inject(DOCUMENT);$/", "language": "TypeScript", "kind": "property", "scope": "FigmaScreenComponent", "scopeKind": "class"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = head.querySelector('base[data-role=\"assets-base-shim\"]') as any;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = head.querySelector(`link[rel=\"stylesheet\"][href=\"${href}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = this.doc.querySelector(`script[src=\"${src}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    const g: any = (typeof globalThis !== 'undefined') ? globalThis : undefined;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "head", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const head = this.doc.head || this.doc.getElementsByTagName('head')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "html", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      let html = await resp.text();$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "js1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js1 = this.appendScript('assets\\/app.js', false);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "js2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js2 = this.appendScript('assets\\/spotify-1-0-3.js', false);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "link", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const link = this.doc.createElement('link');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    for (const node of this.addedNodes) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    let out = html;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "resp", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const resp = await (globalThis as any).fetch('assets\\/spotify-1-0-3.html', { credentials: /", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "script", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const script = this.doc.createElement('script');$/", "language": "TypeScript", "kind": "constant"}], "hash": "78795b2299f64b37faecf76abe51a69c", "format-version": 4, "code-base-name": "web_frontend", "filename": "web_frontend/src/app/figma-screen/figma-screen.component.ts", "fields": [{"name": "private readonly doc = inject(DOCUMENT);", "scope": "FigmaScreenComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "let html = await resp.text();", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let out = html;", "scope": "", "scopeKind": "", "description": "unavailable"}]}