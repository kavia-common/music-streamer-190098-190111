{"is_source_file": true, "format": "TypeScript (Angular component)", "description": "Angular standalone component 'FigmaScreenComponent' that inlines static Figma HTML, manages asset URLs, and injects external stylesheets and scripts directly into the DOM to render a static Figma-designed interface within an Angular app.", "external_files": ["/assets/common.css", "/assets/spotify-1-0-3.css", "/assets/app.js", "/assets/spotify-1-0-3.js"], "external_methods": ["inject", "isPlatformBrowser", "document.head.querySelector", "document.createElement", "appendChild", "remove"], "published": ["htmlContent", "getSourceHtml", "extractBodyInnerHtml", "rewriteAssetUrls", "appendStylesheet", "appendScript"], "classes": [{"name": "FigmaScreenComponent", "description": "Angular component responsible for rendering a static Figma interface by inlining HTML, inlining CSS, and appending JS scripts, without fetching during runtime."}], "methods": [{"name": "ngOnInit", "description": "Initializes the component, injects stylesheet links, inlines HTML content via sanitized string, and appends scripts."}, {"name": "ngOnDestroy", "description": "Cleans up injected DOM nodes to prevent duplicates on navigation or reinitialization."}, {"name": "appendStylesheet", "description": "Appends a stylesheet link to the document head if not already present."}, {"name": "appendScript", "description": "Appends a script element to the document body if not already present."}, {"name": "getSourceHtml", "description": "Returns the hardcoded full HTML source of the embedded Figma HTML, avoiding runtime fetching."}, {"name": "extractBodyInnerHtml", "description": "Extracts and returns only the inner HTML of the body from the full HTML string, stripping script tags for safety."}, {"name": "rewriteAssetUrls", "description": "Rewrites all relative paths in the HTML to absolute /assets/... paths, and removes <link rel=stylesheet> tags to prevent duplicate CSS injection."}], "calls": ["this.appendStylesheet", "this.appendScript", "this.extractBodyInnerHtml", "this.rewriteAssetUrls", "isPlatformBrowser", "this.doc.head.querySelector", "this.doc.createElement", "node.remove"], "search-terms": ["Figma HTML inline injection", "Angular asset URL rewriting", "static embedded HTML", "prevent duplicate stylesheet/script injection", "standalone Angular component for static content"], "state": 2, "file_id": 21, "knowledge_revision": 72, "git_revision": "225919db5faaa0f9b7e75dc979e7764cbd858f6a", "revision_history": [{"43": ""}, {"47": ""}, {"48": ""}, {"49": ""}, {"51": "d996abcea0f056656a880b277976ad2dab0099d9"}, {"52": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"53": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"56": "1515c59f6e8aca661e2b8caf1217a040b9a257f8"}, {"58": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"60": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"61": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"62": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"63": "822b45b52dc34497448ac96ad8dd8f5623c6aa6a"}, {"64": "4b9dc0675dd9a7ae5545a20a373cceabb6fc7151"}, {"70": "157fde7c8bedd3fa7f552e8711f6457899011078"}, {"72": "225919db5faaa0f9b7e75dc979e7764cbd858f6a"}], "ctags": [{"_type": "tag", "name": "FigmaScreenComponent", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^export class FigmaScreenComponent implements OnInit, OnDestroy {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const body = this.doc.body || this.doc.getElementsByTagName('body')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "bodyMatch", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const bodyMatch = html.match(\\/<body[^>]*>([\\\\s\\\\S]*?)<\\\\\\/body>\\/i);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    let content = html;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "css1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const css1 = this.appendStylesheet('\\/assets\\/common.css') || this.appendStylesheet('asset/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "css2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const css2 = this.appendStylesheet('\\/assets\\/spotify-1-0-3.css') || this.appendStylesheet/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "doc", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^  private readonly doc = inject(DOCUMENT);$/", "language": "TypeScript", "kind": "property", "scope": "FigmaScreenComponent", "scopeKind": "class"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = head.querySelector(`link[rel=\"stylesheet\"][href=\"${href}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "existing", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const existing = this.doc.querySelector(`script[src=\"${src}\"]`);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "head", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const head = this.doc.head || this.doc.getElementsByTagName('head')?.[0];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "inlineHtml", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    const inlineHtml = this.rewriteAssetUrls(this.extractBodyInnerHtml(this.getSourceHtml()));$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "js1", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js1 = this.appendScript('\\/assets\\/app.js', false) || this.appendScript('assets\\/app/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "js2", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const js2 = this.appendScript('\\/assets\\/spotify-1-0-3.js', false) || this.appendScript('a/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "link", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const link = this.doc.createElement('link');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "node", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    for (const node of this.addedNodes) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^    let out = html;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "script", "path": "/home/kavia/workspace/code-generation/music-streamer-190098-190111/web_frontend/src/app/figma-screen/figma-screen.component.ts", "pattern": "/^      const script = this.doc.createElement('script');$/", "language": "TypeScript", "kind": "constant"}], "hash": "78387ac96dedfd4726d5af88ffa9ce06", "format-version": 4, "code-base-name": "web_frontend", "filename": "web_frontend/src/app/figma-screen/figma-screen.component.ts", "fields": [{"name": "let content = html;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private readonly doc = inject(DOCUMENT);", "scope": "FigmaScreenComponent", "scopeKind": "class", "description": "unavailable"}, {"name": "let out = html;", "scope": "", "scopeKind": "", "description": "unavailable"}]}